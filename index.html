<!DOCTYPE html>
<html lang="ar">
<head>
  <meta charset="UTF-8">
  <title>ŸÑÿπÿ®ÿ© ÿßŸÑÿ®ÿßŸÑŸàŸÜÿßÿ™ ÿßŸÑÿ≠ÿ≥ÿßÿ®Ÿäÿ© ŸÑŸÑÿ£ÿ∑ŸÅÿßŸÑ</title>
  <style>
    body {
      margin: 0;
      padding: 0;
      text-align: center;
      font-family: 'Tahoma', sans-serif;
      background: linear-gradient(#87ceeb, #ffffff);
      overflow: hidden;
    }
    h1 {
      margin: 10px;
    }
    #question {
      font-size: 28px;
      margin: 15px;
      color: #222;
    }
    #gameArea {
      position: relative;
      width: 100%;
      height: 500px;
      background: #d0f0ff;
      border: 2px solid #333;
      overflow: hidden;
    }
    .balloon {
      position: absolute;
      width: 70px;
      height: 90px;
      border-radius: 50%;
      text-align: center;
      line-height: 90px;
      font-size: 22px;
      font-weight: bold;
      color: #fff;
      cursor: pointer;
      user-select: none;
    }
    #message {
      font-size: 26px;
      margin-top: 15px;
      font-weight: bold;
    }
    #fireworks {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      pointer-events: none;
    }
  </style>
</head>
<body>
  <h1>üéà ŸÑÿπÿ®ÿ© ÿßŸÑÿ®ÿßŸÑŸàŸÜÿßÿ™ ÿßŸÑÿ≠ÿ≥ÿßÿ®Ÿäÿ© üéà</h1>
  <div id="question">ÿßÿ∂ÿ∫ÿ∑ ÿπŸÑŸâ ÿßÿ®ÿØÿ£</div>
  <button onclick="startGame()">ÿßÿ®ÿØÿ£ ÿßŸÑŸÑÿπÿ®ÿ©</button>
  <div id="gameArea"></div>
  <div id="message"></div>
  <canvas id="fireworks"></canvas>

  <audio id="bgMusic" loop>
    <source src="https://www.bensound.com/bensound-music/bensound-littleidea.mp3" type="audio/mpeg">
  </audio>
  <audio id="correctSound">
    <source src="https://www.soundjay.com/buttons/sounds/button-3.mp3" type="audio/mpeg">
  </audio>
  <audio id="wrongSound">
    <source src="https://www.soundjay.com/buttons/sounds/button-10.mp3" type="audio/mpeg">
  </audio>

  <script>
    let level = 1;
    let stage = 1;
    let score = 0;
    let gameInterval;
    const gameArea = document.getElementById("gameArea");
    const questionBox = document.getElementById("question");
    const message = document.getElementById("message");

    function startGame() {
      document.getElementById("bgMusic").play();
      level = 1;
      stage = 1;
      score = 0;
      message.innerHTML = "";
      nextQuestion();
    }

    function getOperation(level) {
      if (level <= 3) return "+";  // ÿ¨ŸÖÿπ
      if (level <= 6) return "-";  // ÿ∑ÿ±ÿ≠
      return "/";                 // ŸÇÿ≥ŸÖÿ©
    }

    function nextQuestion() {
      clearInterval(gameInterval);
      gameArea.innerHTML = "";

      if (level > 9) {
        endGame();
        return;
      }

      let op = getOperation(level);
      let a = Math.floor(Math.random() * 10) + 1;
      let b = Math.floor(Math.random() * 10) + 1;
      if (op === "-" && b > a) [a,b] = [b,a];
      if (op === "/") b = [1,2,5][Math.floor(Math.random()*3)];

      let correct = (op === "+") ? a+b : (op === "-") ? a-b : Math.floor(a/b);
      questionBox.innerText = `${a} ${op} ${b} = ?`;

      for (let i=0; i<4; i++) {
        let balloon = document.createElement("div");
        balloon.classList.add("balloon");
        balloon.style.left = Math.random() * (gameArea.offsetWidth - 70) + "px";
        balloon.style.top = "500px";
        balloon.style.background = randomColor();

        let value = (i===0) ? correct : correct + Math.floor(Math.random()*5)-2;
        balloon.innerText = value;

        balloon.onclick = () => {
          if (value === correct) {
            document.getElementById("correctSound").play();
            score++;
            if (score % 3 === 0) level++;
            nextQuestion();
          } else {
            document.getElementById("wrongSound").play();
            message.innerHTML = "‚ùå ÿ≠ÿßŸàŸÑ ŸÖÿ±ÿ© ÿ£ÿÆÿ±Ÿâ";
          }
        };

        gameArea.appendChild(balloon);
      }

      animateBalloons();
    }

    function animateBalloons() {
      const balloons = document.querySelectorAll(".balloon");
      let speed = 1 + (level*0.3);
      gameInterval = setInterval(() => {
        balloons.forEach(b => {
          b.style.top = (parseInt(b.style.top)-speed)+"px";
          if (parseInt(b.style.top) < -100) {
            b.remove();
          }
        });
      }, 30);
    }

    function endGame() {
      questionBox.innerText = "üéâ ŸÖÿ®ÿ±ŸàŸÉ! ŸÑŸÇÿØ ÿ£ŸÜŸáŸäÿ™ ÿ¨ŸÖŸäÿπ ÿßŸÑŸÖÿ±ÿßÿ≠ŸÑ!";
      message.innerHTML = "üëè ÿ£ŸÜÿ™ ÿ∑ŸÅŸÑ ÿ∞ŸÉŸä ŸàŸÜÿßÿ®ÿ∫ÿ© ŸÅŸä ÿßŸÑÿ≠ÿ≥ÿßÿ®!";
      launchFireworks();
    }

    function randomColor(){
      const colors=["#e74c3c","#3498db","#f1c40f","#2ecc71","#9b59b6"];
      return colors[Math.floor(Math.random()*colors.length)];
    }

    // fireworks ÿ®ÿ≥Ÿäÿ∑
    function launchFireworks(){
      const canvas=document.getElementById("fireworks");
      const ctx=canvas.getContext("2d");
      canvas.width=window.innerWidth;
      canvas.height=window.innerHeight;
      let particles=[];

      function Particle(x,y,color){
        this.x=x;this.y=y;this.color=color;
        this.vx=Math.random()*4-2;
        this.vy=Math.random()*-4-2;
        this.life=100;
      }
      function draw(){
        ctx.clearRect(0,0,canvas.width,canvas.height);
        particles.forEach((p,i)=>{
          ctx.fillStyle=p.color;
          ctx.fillRect(p.x,p.y,4,4);
          p.x+=p.vx;p.y+=p.vy;p.vy+=0.05;p.life--;
          if(p.life<=0)particles.splice(i,1);
        });
      }
      function loop(){
        if(Math.random()<0.1){
          let x=Math.random()*canvas.width;
          let y=Math.random()*canvas.height/2;
          for(let i=0;i<50;i++){
            particles.push(new Particle(x,y,randomColor()));
          }
        }
        draw();
        requestAnimationFrame(loop);
      }
      loop();
    }
  </script>
</body>
</html>
